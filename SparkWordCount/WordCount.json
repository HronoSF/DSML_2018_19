{"paragraphs":[{"text":"import org.apache.spark.sql.types._\nimport org.apache.spark.sql.Row","user":"anonymous","dateUpdated":"2019-05-19T12:12:53+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":false,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.types._\nimport org.apache.spark.sql.Row\n"}]},"apps":[],"jobName":"paragraph_1558217196171_937137380","id":"20190519-010636_457528656","dateCreated":"2019-05-19T01:06:36+0300","dateStarted":"2019-05-19T10:44:08+0300","dateFinished":"2019-05-19T10:44:08+0300","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:32922"},{"text":"//Считываем тексты Oxxxymiron-a:\nval pattern=sc.textFile(\"/home/gleb/Downloads/oxxy.txt\")\n\n//Уберём все,кроме букв и пробелов:\nval nonLetterSymbol=\"\"\"[^a-zA-Z ]\"\"\".r\n\n//Снизим все до lowerCase,разобьем из строки в массив слов,но запишем только слова длины 5 и более,так интереснее:\nval dictionary=pattern.flatMap(line=>nonLetterSymbol.replaceAllIn(line,\"\").toLowerCase().split(\" \").filter(_.length>5))\n\n//Считываем текст Войны и Мира:\nval data=sc.textFile(\"/home/gleb/Downloads/war-peace.txt\")\n\n//Считаем сколько всего слов,просто так:\nval allWordsCountInDataFile=data.count()\n\n//Собираем наши специальные слова:\nval SpecialWords=dictionary.collect()\n\n//Считаем из текста Войны и мира только те слова,которые встречали в текстах Oxxxymiron-a,минимальная длина слова всё так же 5:\nval newData=data.flatMap(line=>nonLetterSymbol.replaceAllIn(line,\"\").toLowerCase().split(\" \").filter(_.length>5).filter(word=>(SpecialWords.contains(word)))).map(word=>(word,1)).reduceByKey(_+_).cache()\n\n//Делаем преобразования для того чтобы посмотреть на полученные данные в sql:\nval fields=List(StructField(\"word\",StringType,true),StructField(\"counts\",IntegerType,true))\nval structure = StructType(fields)\nval rowRDD=newData.map(wc=>Row(wc._1,wc._2))\nval wcDF=sqlContext.createDataFrame(rowRDD,structure)\nwcDF.registerTempTable(\"WordCounts\")\n","user":"anonymous","dateUpdated":"2019-05-19T12:22:04+0300","config":{"colWidth":12,"fontSize":11,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":116.8,"optionOpen":false}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":false,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\npattern: org.apache.spark.rdd.RDD[String] = /home/gleb/Downloads/oxxy.txt MapPartitionsRDD[830] at textFile at <console>:43\nnonLetterSymbol: scala.util.matching.Regex = [^a-zA-Z ]\ndictionary: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[831] at flatMap at <console>:49\ndata: org.apache.spark.rdd.RDD[String] = /home/gleb/Downloads/war-peace.txt MapPartitionsRDD[833] at textFile at <console>:52\nallWordsCountInDataFile: Long = 130670\nSpecialWords: Array[String] = Array(visited, family, diapositive, looking, unfair, discovery, darwin, principle, sneaky, innocents, strong, changed, silent, trench, harbor, amelie, character, resentment, anathema, injured, species, dreams, libido, orders, others, second, famous, hidden, cameras, spotlights, hummers, breathe, quickly, create, retinue, tyr..."}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://gleb-pc.Dlink:4040/jobs/job?id=185","http://gleb-pc.Dlink:4040/jobs/job?id=186"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1558217320804_1814360407","id":"20190519-010840_1076228170","dateCreated":"2019-05-19T01:08:40+0300","dateStarted":"2019-05-19T12:22:04+0300","dateFinished":"2019-05-19T12:22:06+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:32923"},{"text":"%sql\n\nselect *  from WordCounts\nwhere counts>=${minFrequency=1,50|100|150|200} and length(word)>=${minLength=1,5|7|8|9}\norder by counts desc\nlimit 20","user":"anonymous","dateUpdated":"2019-05-19T12:22:09+0300","config":{"colWidth":12,"fontSize":11,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"word":"string","counts":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"word","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"counts","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","runOnSelectionChange":true,"editorHide":false},"settings":{"params":{"minLength":"8","minFrequency":"50"},"forms":{"minFrequency":{"type":"Select","options":[{"value":"50","$$hashKey":"object:33005"},{"value":"100","$$hashKey":"object:33006"},{"value":"150","$$hashKey":"object:33007"},{"value":"200","$$hashKey":"object:33008"}],"name":"minFrequency","defaultValue":"1","hidden":false,"$$hashKey":"object:32990"},"minLength":{"type":"Select","options":[{"value":"5","$$hashKey":"object:33015"},{"value":"7","$$hashKey":"object:33016"},{"value":"8","$$hashKey":"object:33017"},{"value":"9","$$hashKey":"object:33018"}],"name":"minLength","defaultValue":"1","hidden":false,"$$hashKey":"object:32991"}}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"word\tcounts\nsomething\t597\nsuddenly\t428\neverything\t406\neveryone\t216\nhappened\t167\ndifferent\t144\ntogether\t139\nimmediately\t130\nyourself\t117\neverybody\t112\nshoulders\t106\nbeginning\t89\nsurprise\t85\nfinished\t81\nprobably\t78\nshoulder\t58\nmarriage\t57\nservants\t57\ncharacter\t55\ndarkness\t50\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://gleb-pc.Dlink:4040/jobs/job?id=187"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1558251852252_523864963","id":"20190519-104412_104258154","dateCreated":"2019-05-19T10:44:12+0300","dateStarted":"2019-05-19T12:22:09+0300","dateFinished":"2019-05-19T12:22:11+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:32924"}],"name":"WordCount","id":"2ED75RRX8","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"simple","personalizedMode":"false"},"info":{}}